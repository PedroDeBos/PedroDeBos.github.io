<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="INDEXID | Portfolio Pedro de Bos" />
<meta property="og:type" content="book" />







<meta name="description" content="INDEXID | Portfolio Pedro de Bos">

<title>INDEXID | Portfolio Pedro de Bos</title>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="libs/navigation-1.1/tabsets.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.23/datatables.js"></script>
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
/* show arrow before summary tag as in bootstrap
TODO: remove if boostrap in updated in html_document (rmarkdown#1485) */
details > summary {
  display: list-item;
  cursor: pointer;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<!--bookdown:toc:end-->
<!--bookdown:toc:start-->
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="indexid" class="section level1">
<h1>INDEXID</h1>
<body id="start">
<div class="topnav">
<p><a href='index.html#Frontpage'>Frontpage</a>
<a href='data-visualisation.html#data-visualisation'>Data visualisation</a>
<a href='parametized-data-germany.html#parametized-data'>Parametizing data</a>
<a href='directory-structure.html#directory-structure'>Directory structure</a>
<a href='creating-a-r-package.html#creating-a-r-package'>R-package</a>
<a href='sql.html#SQL'>SQL</a>
<a href='bibliography-using-zotero.html#Bibliography using Zotero'>Zotero</a>
<a href='open-reproductibility-analysis.html#open-reproductibility-analysis'>Reproductibility</a>
<a href='future-endeavours.html#future-endeavours'>Future endeavours</a>
<a href='new-skills.html#new-skills'> New skills (Machine learning)</a>
<a href='cv.html#cv'>CV</a>
<a href='bibliography.html#bibliography'>Bibliography</a></p>
</div>
<p> </p>
<p>Now, for the grand finale: we’ll use all previous knowledge we’ve gathered, and study an fully developed microbiology machine learning package in R: IDTAXA.</p>
<p>IDTAXA is part of the DECIPHER package, a package hosted on the bioconductor website. DECIPHER is a “software toolset that can be used for deciphering and managing biological sequences efficiently using R”. It contains functions for many different uses, including maintaining databases, aligning sequences, finding genes, and the main use we’ll be studying, analysing sequences for classification.</p>
<p>IDTAXA contains 2 forms of identification: Taxonomy by organism, and taxonomy by functions. ITDAXA: classify organisms takes rRNA or an ITS sequence, and classifies it as a taxonomy of organisms. IDTAXA: classify functions takes a protein or coding sequence, and classifies it as a taxonomy of functions.</p>
<p>The site for IDTAXA, specifically <a href="http://www2.decipher.codes/ClassifyOrganismsCode.html">this link here</a>, contains a guide on how to perform an IDTAXA identification yourself in R. This guide will be performed on an A: pre-assembled mock data set, B: 3 16sRNA sequences from taken from an online database, and C: 16sRNA sequencces from a random published study.</p>
<p>The process goes as follows: First, store the location of the fasta data, and read it using readDNAStringSet(or RNAStringSet if it’s RNA data). Use “remove gaps” to remove any possible gaps found in the data</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="indexid.html#cb155-1" aria-hidden="true" tabindex="-1"></a>fas<span class="ot">&lt;-</span><span class="st">&quot;./data.raw/HMP_16S.fas.txt&quot;</span></span>
<span id="cb155-2"><a href="indexid.html#cb155-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-3"><a href="indexid.html#cb155-3" aria-hidden="true" tabindex="-1"></a>seqs<span class="ot">&lt;-</span><span class="fu">readDNAStringSet</span>(fas)</span>
<span id="cb155-4"><a href="indexid.html#cb155-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-5"><a href="indexid.html#cb155-5" aria-hidden="true" tabindex="-1"></a>seqs<span class="ot">&lt;-</span><span class="fu">RemoveGaps</span>(seqs)</span></code></pre></div>
<p>Then, load in the training data set downloaded from the DECIPHER website.</p>
<p>(Please keep in mind, loading this data and performing the machine learning is a very CPU-heavy process. In order to make this .Rmd accessible to those without a strong computer, I’ve instead ran the code myself, and will only be showing the plots as output)</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="indexid.html#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;../KEGG_AllLineage_r95.RData&quot;</span>)</span></code></pre></div>
<p>Now, let the IdTaxa algorythm run, store the output, and use plot() to immdiately plot the output</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="indexid.html#cb157-1" aria-hidden="true" tabindex="-1"></a>ids<span class="ot">&lt;-</span><span class="fu">IdTaxa</span>(seqs,</span>
<span id="cb157-2"><a href="indexid.html#cb157-2" aria-hidden="true" tabindex="-1"></a>            trainingSet,</span>
<span id="cb157-3"><a href="indexid.html#cb157-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">strand =</span> <span class="st">&quot;both&quot;</span>,</span>
<span id="cb157-4"><a href="indexid.html#cb157-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">threshold =</span> <span class="dv">60</span>,</span>
<span id="cb157-5"><a href="indexid.html#cb157-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">processors =</span> <span class="cn">NULL</span>)</span>
<span id="cb157-6"><a href="indexid.html#cb157-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ids)</span>
<span id="cb157-7"><a href="indexid.html#cb157-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ids)</span></code></pre></div>
<p>print(ids)</p>
<p>A test set of class ‘Taxa’ with length 118</p>
<pre><code>  confidence name                 taxon</code></pre>
<p>[1] 78% Acinetobacter bau… Root; Bacteria; Proteobacteria; Gammaproteobacteria; Pseudomonadales; Moraxellaceae; Acinetobacter<br />
[2] 78% Acinetobacter bau… Root; Bacteria; Proteobacteria; Gammaproteobacteria; Pseudomonadales; Moraxellaceae; Acinetobacter<br />
[3] 78% Acinetobacter bau… Root; Bacteria; Proteobacteria; Gammaproteobacteria; Pseudomonadales; Moraxellaceae; Acinetobacter<br />
[4] 78% Acinetobacter bau… Root; Bacteria; Proteobacteria; Gammaproteobacteria; Pseudomonadales; Moraxellaceae; Acinetobacter<br />
[5] 78% Acinetobacter bau… Root; Bacteria; Proteobacteria; Gammaproteobacteria; Pseudomonadales; Moraxellaceae; Acinetobacter<br />
… … … …</p>
<p>[114] 57% Streptococcus mut… Root; unclassified_Root<br />
[115] 81% Streptococcus pne… Root; Bacteria; Firmicutes; Bacilli; Lactobacillales; Streptococcaceae; Streptococcus<br />
[116] 81% Streptococcus pne… Root; Bacteria; Firmicutes; Bacilli; Lactobacillales; Streptococcaceae; Streptococcus<br />
[117] 81% Streptococcus pne… Root; Bacteria; Firmicutes; Bacilli; Lactobacillales; Streptococcaceae; Streptococcus<br />
[118] 81% Streptococcus pne… Root; Bacteria; Firmicutes; Bacilli; Lactobacillales; Streptococcaceae; Streptococcus</p>
<p><img src="images/IDTAXA_1.png"></p>
<p>And easy as that, you’ve used IdTaxa machine learning to identify the given 16s RNA sequences.</p>
<p>That was for a training dataset that was already pre-assembled. But what if you’ve got a bunch of individual 16s RNA strands, of which you want to identify all of them? For that, we’ll need to manually take some 16s RNA sequences, and put them together into a single file via R.</p>
<p>I’ve taken 3 random bacterial DNA sequences:</p>
<ul>
<li>One from <a href="https://www.ncbi.nlm.nih.gov/genome/175?genome_assembly_id=383877">streptococcus pyogenes</a>,</li>
<li>one from <a href="https://www.ncbi.nlm.nih.gov/genome/154?genome_assembly_id=360991">staphylococcus aureus</a> and finally,</li>
<li>one from <a href="https://www.ncbi.nlm.nih.gov/genome/152?genome_assembly_id=299225">Salmonella enterica typhi</a>.</li>
</ul>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="indexid.html#cb159-1" aria-hidden="true" tabindex="-1"></a>fas1<span class="ot">&lt;-</span><span class="st">&quot;./data.raw/AB002521.1.fasta&quot;</span></span>
<span id="cb159-2"><a href="indexid.html#cb159-2" aria-hidden="true" tabindex="-1"></a>fas2<span class="ot">&lt;-</span><span class="st">&quot;./data.raw/AB243005.1.fasta&quot;</span></span>
<span id="cb159-3"><a href="indexid.html#cb159-3" aria-hidden="true" tabindex="-1"></a>fas3<span class="ot">&lt;-</span><span class="st">&quot;./data.raw/AB594754.1.fasta&quot;</span></span>
<span id="cb159-4"><a href="indexid.html#cb159-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-5"><a href="indexid.html#cb159-5" aria-hidden="true" tabindex="-1"></a>seqs<span class="ot">&lt;-</span><span class="fu">readDNAStringSet</span>(<span class="fu">c</span>(fas1, fas2, fas3))</span>
<span id="cb159-6"><a href="indexid.html#cb159-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-7"><a href="indexid.html#cb159-7" aria-hidden="true" tabindex="-1"></a>seqs<span class="ot">&lt;-</span><span class="fu">RemoveGaps</span>(seqs)</span>
<span id="cb159-8"><a href="indexid.html#cb159-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-9"><a href="indexid.html#cb159-9" aria-hidden="true" tabindex="-1"></a>ids<span class="ot">&lt;-</span><span class="fu">IdTaxa</span>(seqs,</span>
<span id="cb159-10"><a href="indexid.html#cb159-10" aria-hidden="true" tabindex="-1"></a>            trainingSet,</span>
<span id="cb159-11"><a href="indexid.html#cb159-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">strand =</span> <span class="st">&quot;both&quot;</span>,</span>
<span id="cb159-12"><a href="indexid.html#cb159-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">threshold =</span> <span class="dv">60</span>,</span>
<span id="cb159-13"><a href="indexid.html#cb159-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">processors =</span> <span class="cn">NULL</span>)</span>
<span id="cb159-14"><a href="indexid.html#cb159-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ids)</span>
<span id="cb159-15"><a href="indexid.html#cb159-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ids)</span></code></pre></div>
<p>print(ids)</p>
<p>A test set of class ‘Taxa’ with length 3</p>
<pre><code>confidence name                 taxon</code></pre>
<p>[1] 81% ENA|AB002521|AB00… Root; Bacteria; Firmicutes; Bacilli; Lactobacillales; Streptococcaceae; Streptococcus<br />
[2] 80% ENA|AB243005|AB24… Root; Bacteria; Firmicutes; Bacilli; Bacillales; Staphylococcaceae; Staphylococcus<br />
[3] 85% ENA|AB594754|AB59… Root; Bacteria; Proteobacteria; Gammaproteobacteria; Enterobacteriales; Enterobacteriaceae; Salmonella</p>
<p><img src="images/IDTAXA_2.png"></p>
<p>And thus, like that, we’ve officially learned how to use the IDTAXA machine learning method for 16s RNA! In the final page of this small research project into machine learning, I’ve written a self-reflection on what I’ve learned through performing this research project, some closing thoughts.</p>

</div>
<p style="text-align: center;">
<a href="random-forest-in-glass.html"><button class="btn btn-default">Previous</button></a>
<a href="closing-words.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
